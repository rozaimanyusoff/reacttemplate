import{u as S,a as j,r as i,s as L,j as l,b as e,i as T,k as A}from"./index-0cfac8c6.js";import{S as P}from"./sweetalert2.all-b2d40738.js";import{I as D}from"./IconUserPlus-b3d0ddd9.js";import{I as _}from"./IconListCheck-ff366975.js";import{I as M}from"./IconLayoutGrid-32746dd3.js";import{I as R}from"./IconFacebook-a29d830b.js";import{I as $}from"./IconInstagram-1545bd15.js";import{I as z}from"./IconLinkedin-2022d704.js";import{I as G}from"./IconTwitter-bfa78d4b.js";import{Y as b,y as E}from"./transition-4e54ca50.js";import"./keyboard-0285eef4.js";import"./open-closed-fcf715e6.js";import"./hidden-c16f601c.js";const le=()=>{const v=S(),m=j(t=>t.auth.token);i.useEffect(()=>{console.log("Token retrieved from Redux:",m),m&&w()},[m]);const[n,h]=i.useState([]),[s,p]=i.useState([]),[c,U]=i.useState(""),[g,d]=i.useState(!1),[u,N]=i.useState("list"),[a,x]=i.useState({id:null,username:"",name:"",staffId:"",email:"",phone:"",role:"",level:"",team:"",userType:"",lastLogin:""}),[O,y]=i.useState("");i.useEffect(()=>{v(L("Users")),w()},[v]),i.useEffect(()=>{p(n.filter(t=>t.username.toLowerCase().includes(c.toLowerCase())||t.fname.toLowerCase().includes(c.toLowerCase())||t.email.toLowerCase().includes(c.toLowerCase())))},[c,n]);const w=async()=>{try{const t=await fetch(`https://j8.ranhilltechnologies.com.my/api/admin/data_admin?params=users&token=${m}`,{method:"GET",headers:{"Content-Type":"application/json"}});console.log("Response:",t),console.log("Headers:",t.headers);const r=await t.json();console.log("Data:",r),t.ok&&r.status==="Success"?h(r.users):y(r.message||"Failed to fetch user data")}catch(t){console.error("Fetch User Error:",t),y("An error occurred. Please try again.")}},o=t=>{const{value:r,id:I}=t.target;x({...a,[I]:r})},F=()=>{if(!a.name||!a.email||!a.phone||!a.role){f("All fields are required.","error");return}if(a.id)h(n.map(t=>t.id===a.id?a:t)),p(s.map(t=>t.id===a.id?a:t));else{const t={...a,id:n.length?Math.max(...n.map(r=>r.id))+1:1};h([t,...n]),p([t,...s])}f("User has been saved successfully."),d(!1)},k=t=>{x(t),d(!0)},C=t=>{h(n.filter(r=>r.id!==t.id)),p(s.filter(r=>r.id!==t.id)),f("User has been deleted successfully.")},f=(t="",r="success")=>{P.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:r,title:t,padding:"10px 20px"})};return l("div",{children:[l("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e("h2",{className:"text-xl",children:"Users"})," ",l("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:[l("div",{className:"flex gap-3",children:[e("div",{children:l("button",{type:"button",className:"btn btn-primary",onClick:()=>d(!0),children:[e(D,{className:"ltr:mr-2 rtl:ml-2"}),"Add User"]})}),e("div",{children:e("button",{type:"button",className:`btn btn-outline-primary p-2 ${u==="list"&&"bg-primary text-white"}`,onClick:()=>N("list"),children:e(_,{})})}),e("div",{children:e("button",{type:"button",className:`btn btn-outline-primary p-2 ${u==="grid"&&"bg-primary text-white"}`,onClick:()=>N("grid"),children:e(M,{})})})]}),l("div",{className:"relative",children:[e("input",{type:"text",placeholder:"Search Users",className:"form-input py-2 ltr:pr-11 rtl:pl-11 peer",value:c,onChange:t=>U(t.target.value)}),e("button",{type:"button",className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:e(T,{className:"mx-auto"})})]})]})]}),u==="list"&&e("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:e("div",{className:"table-responsive",children:l("table",{className:"table-striped table-hover",children:[e("thead",{children:l("tr",{children:[e("th",{children:"ID"}),e("th",{children:"Username"}),e("th",{children:"Name"}),e("th",{children:"Staff ID"}),e("th",{children:"Email"}),e("th",{children:"Phone"}),e("th",{children:"Role"}),e("th",{children:"Level"}),e("th",{children:"Team"}),e("th",{children:"Status"}),e("th",{children:"Type"}),e("th",{children:"Last Login"}),e("th",{className:"!text-center",children:"Actions"})]})}),e("tbody",{children:s.length===0?e("tr",{children:e("td",{colSpan:12,className:"text-center",children:"No users found."})}):s.map(t=>l("tr",{children:[e("td",{children:t.id}),e("td",{children:t.username}),e("td",{children:t.fname}),e("td",{children:t.staff_id}),e("td",{children:t.email}),e("td",{children:t.ctc}),e("td",{children:t.level_name}),e("td",{children:t.level}),e("td",{children:t.team}),e("td",{children:t.status}),e("td",{children:t.type}),e("td",{children:t.last_login||"Never"}),e("td",{children:l("div",{className:"flex gap-4 items-center justify-center",children:[e("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>k(t),children:"Edit"}),e("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>C(t),children:"Delete"})]})})]},t.id))})]})})}),u==="grid"&&e("div",{className:"grid 2xl:grid-cols-4 xl:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-6 mt-5 w-full",children:s.map(t=>e("div",{className:"bg-white dark:bg-[#1c232f] rounded-md overflow-hidden text-center shadow relative",children:l("div",{className:"bg-white dark:bg-[#1c232f] rounded-md overflow-hidden text-center shadow relative",children:[e("div",{className:"bg-white/40 rounded-t-md bg-center bg-cover p-6 pb-0 bg-",style:{backgroundImage:"url('/assets/images/notification-bg.png')",backgroundRepeat:"no-repeat",width:"100%",height:"100%"},children:e("img",{className:"object-contain w-4/5 max-h-40 mx-auto",src:`/assets/images/${t.path}`,alt:"contact_image"})}),l("div",{className:"px-6 pb-24 -mt-10 relative",children:[l("div",{className:"shadow-md bg-white dark:bg-gray-900 rounded-md px-2 py-4",children:[e("div",{className:"text-xl",children:t.name}),e("div",{className:"text-white-dark",children:t.role}),l("div",{className:"flex items-center justify-between flex-wrap mt-6 gap-3",children:[l("div",{className:"flex-auto",children:[e("div",{className:"text-info",children:t.posts}),e("div",{children:"Posts"})]}),l("div",{className:"flex-auto",children:[e("div",{className:"text-info",children:t.following}),e("div",{children:"Following"})]}),l("div",{className:"flex-auto",children:[e("div",{className:"text-info",children:t.followers}),e("div",{children:"Followers"})]})]}),e("div",{className:"mt-4",children:l("ul",{className:"flex space-x-4 rtl:space-x-reverse items-center justify-center",children:[e("li",{children:e("button",{type:"button",className:"btn btn-outline-primary p-0 h-7 w-7 rounded-full",children:e(R,{})})}),e("li",{children:e("button",{type:"button",className:"btn btn-outline-primary p-0 h-7 w-7 rounded-full",children:e($,{})})}),e("li",{children:e("button",{type:"button",className:"btn btn-outline-primary p-0 h-7 w-7 rounded-full",children:e(z,{})})}),e("li",{children:e("button",{type:"button",className:"btn btn-outline-primary p-0 h-7 w-7 rounded-full",children:e(G,{})})})]})})]}),l("div",{className:"mt-6 grid grid-cols-1 gap-4 ltr:text-left rtl:text-right",children:[l("div",{className:"flex items-center",children:[e("div",{className:"flex-none ltr:mr-2 rtl:ml-2",children:"Email :"}),e("div",{className:"truncate text-white-dark",children:t.email})]}),l("div",{className:"flex items-center",children:[e("div",{className:"flex-none ltr:mr-2 rtl:ml-2",children:"Phone :"}),e("div",{className:"text-white-dark",children:t.phone})]}),l("div",{className:"flex items-center",children:[e("div",{className:"flex-none ltr:mr-2 rtl:ml-2",children:"Address :"}),e("div",{className:"text-white-dark",children:t.location})]})]})]}),l("div",{className:"mt-6 flex gap-4 absolute bottom-0 w-full ltr:left-0 rtl:right-0 p-6",children:[e("button",{type:"button",className:"btn btn-outline-primary w-1/2",onClick:()=>k(t),children:"Edit"}),e("button",{type:"button",className:"btn btn-outline-danger w-1/2",onClick:()=>C(t),children:"Delete"})]})]})},t.id))}),e(b,{appear:!0,show:g,as:i.Fragment,children:l(E,{as:"div",open:g,onClose:()=>d(!1),className:"relative z-[51]",children:[e(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:l(E.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>d(!1),className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e(A,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:a.id?"Edit Contact":"Add Contact"}),e("div",{className:"p-5",children:l("form",{children:[l("div",{className:"mb-5",children:[e("label",{htmlFor:"name",children:"Name"}),e("input",{id:"name",type:"text",placeholder:"Enter Name",className:"form-input",value:a.name,onChange:t=>o(t)})]}),l("div",{className:"mb-5",children:[e("label",{htmlFor:"email",children:"Email"}),e("input",{id:"email",type:"email",placeholder:"Enter Email",className:"form-input",value:a.email,onChange:t=>o(t)})]}),l("div",{className:"mb-5",children:[e("label",{htmlFor:"number",children:"Phone Number"}),e("input",{id:"phone",type:"text",placeholder:"Enter Phone Number",className:"form-input",value:a.phone,onChange:t=>o(t)})]}),l("div",{className:"mb-5",children:[e("label",{htmlFor:"occupation",children:"Occupation"}),e("input",{id:"role",type:"text",placeholder:"Enter Occupation",className:"form-input",value:a.role,onChange:t=>o(t)})]}),l("div",{className:"mb-5",children:[e("label",{htmlFor:"address",children:"Address"}),e("textarea",{id:"location",rows:3,placeholder:"Enter Address",className:"form-textarea resize-none min-h-[130px]",value:a.location,onChange:t=>o(t)})]}),l("div",{className:"flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>d(!1),children:"Cancel"}),e("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:F,children:a.id?"Update":"Add"})]})]})})]})})})})]})})]})};export{le as default};
